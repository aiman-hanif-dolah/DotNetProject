@model IEnumerable<DotNetProject.Models.Location>
@{
    ViewData["Title"] = "Locations";
    var fallbackImage = "https://wallpapers.com/images/hd/friends-tv-show-characters-8t1z1sj8k7wh4i0v.jpg";
}

<h1 class="page-title">Locations</h1>

<div class="mb-4">
    <a asp-action="Create" class="btn-neon btn-neon-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
        Add New Location
    </a>
</div>

<div class="row g-4">
    @foreach (var item in Model)
    {
        var heroImage = ImageUrlHelper.Resolve(item.ImageUrl, FirebaseOptions.Value) ?? fallbackImage;
        var videoLink = !string.IsNullOrWhiteSpace(item.VideoUrl)
            ? item.VideoUrl
            : $"https://www.youtube.com/embed?listType=search&list={System.Net.WebUtility.UrlEncode(item.Name + " Friends set")}";

        <div class="col-lg-4 col-md-6 animate-item">
            <div class="glass-card h-100 d-flex flex-column">
                <div class="media-banner">
                    <img class="media-img" src="@heroImage" alt="@item.Name" loading="lazy" onerror="this.onerror=null;this.src='@fallbackImage';" />
                    <div class="media-gradient"></div>
                    <span class="badge badge-glow">@item.Type</span>
                    <div class="media-banner__title">
                        <h4>@item.Name</h4>
                        @if (!string.IsNullOrWhiteSpace(item.Address))
                        {
                            <small>@item.Address</small>
                        }
                    </div>
                </div>

                @if (!string.IsNullOrWhiteSpace(item.Description))
                {
                    <p class="mt-3" style="color: var(--text-secondary);">@item.Description</p>
                }

                <div class="action-buttons mt-auto">
                    <a asp-action="Details" asp-route-id="@item.Id" class="btn-neon btn-neon-secondary" style="padding: 0.5rem 1rem; font-size: 0.8rem;">View</a>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn-neon btn-neon-primary" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Edit</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn-neon btn-neon-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Delete</a>
                    <a href="@videoLink" target="_blank" rel="noopener" class="btn-neon btn-neon-purple" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Set tour</a>
                </div>
            </div>
        </div>
    }
</div>

@if (!Model.Any())
{
    <div class="glass-card text-center py-5">
        <div style="font-size: 4rem; opacity: 0.3; margin-bottom: 1rem;">üìç</div>
        <p style="color: var(--text-muted); font-size: 1.1rem;">No locations found.</p>
        <a asp-action="Create" class="btn-neon btn-neon-primary mt-3">Add First Location</a>
    </div>
}
