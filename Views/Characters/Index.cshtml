@model IEnumerable<DotNetProject.Models.Character>
@{
    ViewData["Title"] = "Characters";
    var fallbackImage = "https://wallpapers.com/images/hd/friends-tv-show-characters-8t1z1sj8k7wh4i0v.jpg";
}

<h1 class="page-title">Characters</h1>

<div class="mb-4">
    <a asp-action="Create" class="btn-neon btn-neon-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></svg>
        Add New Character
    </a>
</div>

<div class="row g-4">
    @foreach (var item in Model)
    {
        var heroImage = string.IsNullOrWhiteSpace(item.ImageUrl) ? fallbackImage : item.ImageUrl;
        var videoLink = !string.IsNullOrWhiteSpace(item.VideoUrl)
            ? item.VideoUrl
            : $"https://www.youtube.com/embed?listType=search&list={System.Net.WebUtility.UrlEncode(item.Name + " Friends scene")}";

        <div class="col-lg-4 col-md-6 animate-item">
            <div class="glass-card h-100 d-flex flex-column">
                <div class="media-banner">
                    <img class="media-img" src="@heroImage" alt="@item.Name" loading="lazy" onerror="this.onerror=null;this.src='@fallbackImage';" />
                    <div class="media-gradient"></div>
                    @if (!string.IsNullOrWhiteSpace(item.Occupation))
                    {
                        <span class="badge badge-glow">@item.Occupation</span>
                    }
                    <div class="media-banner__title">
                        <h4>@item.Name</h4>
                        <small>Played by @item.ActorName</small>
                    </div>
                </div>

                @if (!string.IsNullOrWhiteSpace(item.Description))
                {
                    <p class="mt-3" style="color: var(--text-secondary);">@item.Description</p>
                }

                <div class="action-buttons mt-auto">
                    <a asp-action="Details" asp-route-id="@item.Id" class="btn-neon btn-neon-secondary" style="padding: 0.5rem 1rem; font-size: 0.8rem;">View</a>
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn-neon btn-neon-primary" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Edit</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn-neon btn-neon-danger" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Delete</a>
                    <a href="@videoLink" target="_blank" rel="noopener" class="btn-neon btn-neon-purple" style="padding: 0.5rem 1rem; font-size: 0.8rem;">Watch clip</a>
                </div>
            </div>
        </div>
    }
</div>

@if (!Model.Any())
{
    <div class="glass-card text-center py-5">
        <div style="font-size: 4rem; opacity: 0.3; margin-bottom: 1rem;">ðŸ‘¤</div>
        <p style="color: var(--text-muted); font-size: 1.1rem;">No characters found.</p>
        <a asp-action="Create" class="btn-neon btn-neon-primary mt-3">Add First Character</a>
    </div>
}
